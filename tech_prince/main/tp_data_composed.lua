local panel_data = {
-- War furnace
{
	{
		prefab = "tp_alloy",
		img = "tp_alloy#",
		ingds = {
			"bluegem", "bluegem", "goldnugget", "goldnugget",
		},
	},
	{
		prefab = "tp_spear_lance",
		img = "spear_forge_lance#",
		ingds = {
			"goldnugget", "rope", "twigs", "twigs",
		},
	},
	{
		prefab = "tp_spear_gungnir",
		img = "spear_forge_gungnir#",
		ingds = {
			"goldnugget", "rope", "rope", "twigs",
		},
	},
	{
		prefab = "tp_spear_wrestle",
		img = "spear_wathgrithr_wrestle#",
		ingds = {
			"goldnugget", "goldnugget", "rope", "twigs",
		},
	},
	{
		prefab = "tp_spear_ice",
		img = "tp_spear_ice#",
		ingds = {
			"spear_forge_lance#", "tp_alloy#", "rope", "bluegem",
		},
	},
	{
		prefab = "tp_spear_fire",
		img = "tp_spear_fire#",
		ingds = {
			"spear_forge_lance#", "tp_alloy#", "rope", "redgem",
		},
	},
	{
		prefab = "tp_spear_thunder",
		img = "tp_spear_thunder#",
		ingds = {
			"spear_forge_lance#", "tp_alloy#", "rope", "purplegem",
		},
	},
	{
		prefab = "tp_spear_trap",
		img = "spear_rose#",
		ingds = {
			"spear_forge_lance#", "tp_alloy#", "rope", "petals",
		},
	},
	{
		prefab = "tp_spear_combat",
		img = "tp_spear_combat#",
		ingds = {
			"spear_forge_lance#", "tp_alloy#", "rope", "spear",
		},
	},
	{
		prefab = "tp_spear_poison",
		img = "tp_spear_poison#",
		ingds = {
			"spear_forge_gungnir#", "tp_alloy#", "tp_alloy#", "greengem",
		},
	},
	{
		prefab = "tp_spear_shadow",
		img = "tp_spear_shadow#",
		ingds = {
			"spear_forge_gungnir#", "tp_alloy#", "tp_alloy#", "yellowgem",
		},
	},
	{
		prefab = "tp_spear_blood",
		img = "tp_spear_blood#",
		ingds = {
			"spear_forge_gungnir#", "tp_alloy#", "tp_alloy#", "orangegem",
		},
	},
	{
		prefab = "tp_spear_gold",
		img = "tp_spear_gold#",
		ingds = {
			"spear_forge_gungnir#", "tp_alloy#", "rope", "goldnugget",
		},
	},
	{
		prefab = "tp_spear_lightning",
		img = "tp_spear_lightning#",
		ingds = {
			"spear_wathgrithr_wrestle#", "tp_alloy#", "rope", "purplegem",
		},
	},
	{
		prefab = "tp_spear_earth",
		img = "tp_spear_earth#",
		ingds = {
			"spear_wathgrithr_wrestle#", "tp_alloy#", "rope", "redgem",
		},
	},
	{
		prefab = "tp_spear_shine",
		img = "tp_spear_shine#",
		ingds = {
			"spear_wathgrithr_wrestle#", "tp_alloy#", "rope", "yellowgem",
		},
	},
	{
		prefab = "tp_spear_tornado",
		img = "tp_spear_tornado#",
		ingds ={
			"spear_wathgrithr_wrestle#", "tp_alloy#", "rope", "gears",
		},
	},
	{
		prefab = "tp_spear_diamond",
		img = "tp_spear_diamond#",
		ingds = {
			"tp_spear_diamond#", "tp_alloy#", "flint", "flint",
		},
	},
	{
		prefab = "tp_spear_bag",
		img = "tp_spear_bag#",
		ingds = {
			"spear", "tp_alloy#", "rope", "pigskin",
		},
	},
	{
		prefab = "tp_spear_beefalo",
		img = "tp_spear_beefalo#",
		ingds = {
			"spear", "twigs", "rope", "beefalowool",
		},
	},
	{
		prefab = "tp_spear_conqueror",
		img = "tp_spear_conqueror#",
		ingds = {
			"spear", "twigs", "rope", "redgem",
		},
	},
	{
		prefab = "tp_spear_speed",
		img = "tp_spear_speed#",
		ingds = {
			"spear", "twigs", "rope", "cactus_meat",
		},
	},
	{
		prefab = "tp_cutlass",
		img = "tp_cutlass#",
		ingds = {
			"dead_swordfish", "tp_alloy#", "tp_alloy#", "tp_alloy#",
		},
	},
	{
		prefab = "tp_staff_trinity",
		img = "spear_bee#",
		ingds = {
			"spear", "redgem", "bluegem", "rope",
		},
	},
	{
		prefab = "tp_spear_wind",
		img = "tp_spear_wind#",
		ingds = {
			"spear_forge_lance#", "tp_gingko_leaf#", "tp_alloy#", "tp_alloy#",
		},
	},
	{
		prefab = "tp_forest_gun",
		img = "tp_forest_gun#",
		ingds = {
			"minotaurhorn", "scroll_wind#", "scroll_wind#", "scroll_wind#",
		},
	},
	{
		prefab = "tp_unreal_sword",
		img = "nightsword_sharp#",
		ingds = {
			"nightmarefuel", "purplegem", "scroll_pig_health#", "tp_alloy#",
		},
	},
	{
		prefab = "tp_bat_scythe",
		img = "batbat_scythe#",
		ingds = {
			"twigs", "rope", "flint", "batwing",
		},
	},
},
-- War furnace II
{
	{
		prefab = "tp_armor_lamellar",
		img = "armor_wood_lamellar#",
		ingds = {
			"boards", "boards", "rope", "goldnugget",
		},
	},
	{
		prefab = "tp_armor_warm",
		img = "tp_armor_warm#",
		ingds = {
			"armor_wood_lamellar#", "tp_alloy#", "boards", "heatrock",
		},
	},
	{
		prefab = "tp_armor_cool",
		img = "tp_armor_cool#",
		ingds = {
			"armor_wood_lamellar#", "tp_alloy#", "boards", "transistor",
		},
	},
	{
		prefab = "tp_armor_thunder",
		img = "tp_armor_thunder#",
		ingds = {
			"armor_wood_lamellar#", "tp_alloy#", "boards", "purplegem",
		},
	},
	{
		prefab = "tp_armor_health",
		img = "tp_armor_health#",
		ingds = {
			"armor_wood_lamellar#", "tp_alloy#", "boards", "redgem",
		},
	},
	{
		prefab = "tp_armor_firm",
		img = "tp_armor_firm#",
		ingds = {
			"armor_wood_lamellar#", "tp_alloy#", "boards", "alloy",
		},
	},
	{
		prefab = "tp_armor_ancient",
		img = "armor_ruins_tusk#",
		ingds = {
			"armorruins", "tp_alloy#", "tp_alloy#", "purplegem",
		},
	},
	{
		prefab = "tp_armor_ancient2",
		img = "armor_ruins_bulky#",
		ingds = {
			"armorruins", "tp_alloy#", "tp_alloy#", "redgem",
		},
	},
	{
		prefab = "tp_armor_ancient3",
		img = "armor_ruins_leaf#",
		ingds = {
			"armorruins", "tp_alloy#", "tp_alloy#", "bluegem",
		},
	},
	{
		prefab = "tp_hat_helm",
		img = "footballhat_combathelm2#",
		ingds = {
			"pigskin", "rope", "goldnugget", "goldnugget",
		},
	},
	{
		prefab = "tp_hat_health",
		img = "tp_hat_health#",
		ingds = {
			"footballhat_combathelm2#", "tp_alloy#", "rope", "goldnugget",
		},
	},
	{
		prefab = "tp_hat_warm",
		img = "tp_hat_warm#",
		ingds = {
			"footballhat_combathelm2#", "tp_alloy#", "rope", "redgem",
		},
	},
	{
		prefab = "tp_hat_cool",
		img = "tp_hat_cool#",
		ingds = {
			"footballhat_combathelm2#", "tp_alloy#", "rope", "bluegem",
		},
	},
	{
		prefab = "tp_hat_antitoxin",
		img = "tp_hat_antitoxin#",
		ingds = {
			"footballhat_combathelm2#", "tp_alloy#", "rope", "cactus_flower",
		},
	},
	{
		prefab = "tp_hat_ancient",
		img = "ruinshat_arcane#",
		ingds = {
			"tp_alloy#", "tp_alloy#", "tp_alloy#", "ruinshat",
		},
	},
	{
		prefab = "tp_ballhat",
		img = "footballhat_combathelm#",
		ingds = {
			"pigskin", "rope", "rope", "tp_alloy#",
		},
	},
	{
		prefab = "tp_woodarmor",
		img = "armor_wood_fangedcollar#",
		ingds = {
			"boards", "boards", "rope", "houndstooth",
		},
	},
	{
		prefab = "tp_oak_armor",
		img = "armor_wood_haramaki#",
		ingds = {
			"armorwood", "tp_gingko_leaf#", "tp_gingko_leaf#", "tp_gingko_leaf#",
		},
	},
	{
		prefab = "tp_brave_amulet",
		img = "amulet_red_occulteye#",
		ingds = {
			"greengem", "orangegem", "yellowgem", "nightmarefuel",
		},
	},
	{
		prefab = "tp_fix_powder",
		img = "tp_fix_powder#",
		ingds = {
			"goldnugget", "goldnugget", "flint", "flint",
		},
	},
	{
		prefab = "tp_ruinbat",
		img = "ruins_bat_heavy#",
		ingds = {
			"ruins_bat", "tp_alloy#", "tp_alloy#", "tp_alloy#",
		},
	},
	{
		prefab = "tp_ruinbat_deerclops",
		img = "tp_ruinbat_deerclops#",
		ingds = {
			"ruins_bat_heavy#", "tp_alloy#", "tp_epic#", "deerclops_eyeball",
		},
	},
	{
		prefab = "tp_ruinbat_dragonfly",
		img = "tp_ruinbat_dragonfly#",
		ingds = {
			"ruins_bat_heavy#", "tp_alloy#", "tp_epic#", "dragon_scales",
		},
	},
	{
		prefab = "tp_ruinbat_bearger",
		img = "tp_ruinbat_bearger#",
		ingds = {
			"ruins_bat_heavy#", "tp_alloy#", "tp_epic#", "bearger_fur",
		},
	},
	{
		prefab = "tp_ruinbat_moose",
		img = "tp_ruinbat_moose#",
		ingds = {
			"ruins_bat_heavy#", "tp_alloy#", "tp_epic#", "goose_feather",
		},
	},
},
-- Graph desk
{
	{
		prefab = "scroll_tentacle",
		img = "scroll_tentacle#",
		ingds = {
			"papyrus", "honey", "nightmarefuel", "tentaclespots",
		},
	},
	{
		prefab = "scroll_bird",
		img = "scroll_bird#",
		ingds = {
			"papyrus", "honey", "nightmarefuel", "feather_robin",
		},
	},
	{
		prefab = "scroll_sleep",
		img = "scroll_sleep#",
		ingds = {
			"papyrus", "honey", "nightmarefuel", "nightmarefuel",
		},
	},
	{
		prefab = "scroll_lightning",
		img = "scroll_lightning#",
		ingds = {
			"papyrus", "honey", "nightmarefuel", "redgem",
		},
	},
	{
		prefab = "scroll_grow",
		img = "scroll_grow#",
		ingds = {
			"papyrus", "honey", "nightmarefuel", "seeds",
		},
	},
	{
		prefab = "scroll_volcano",
		img = "scroll_volcano#",
		ingds = {
			"papyrus", "honey", "nightmarefuel", "obsidian",
		},
	},
	{
		prefab = "scroll_wind",
		img = "scroll_wind#",
		ingds = {
			"papyrus", "tp_gingko_leaf#", "tp_gingko_leaf#", "goose_feather",
		},
	},
	{
		prefab = "scroll_pigman",
		img = "scroll_pigman#",
		ingds = {
			"papyrus", "honey", "nightmarefuel", "pigskin",
		},
	},
	{
		prefab = "scroll_bunnyman",
		img = "scroll_bunnyman#",
		ingds = {
			"papyrus", "honey", "nightmarefuel", "manrabbit_tail",
		},
	},
	{
		prefab = "scroll_shadow",
		img = "scroll_shadow#",
		ingds = {
			"papyrus", "honey", "nightmarefuel", "purplegem",
		},
	},
	{
		prefab = "scroll_harvest",
		img = "scroll_harvest#",
		ingds = {
			"papyrus", "honey", "nightmarefuel", "berries",
		},
	},
	{
		prefab = "scroll_pig_armor",
		img = "scroll_pig_armor#",
		ingds = {
			"papyrus", "honey", "nightmarefuel", "footballhat",
		},
	},
	{
		prefab = "scroll_pig_armorex",
		img = "scroll_pig_armorex#",
		ingds = {
			"papyrus", "honey", "nightmarefuel", "armorwood",
		},
	},
	{
		prefab = "scroll_pig_damage",
		img = "scroll_pig_damage#",
		ingds = {
			"papyrus", "honey", "nightmarefuel", "hambat",
		},
	},
	{
		prefab = "scroll_pig_speed",
		img = "scroll_pig_speed#",
		ingds = {
			"papyrus", "honey", "nightmarefuel", "coffeebeans",
		},
	},
	{
		prefab = "scroll_pig_heal",
		img = "scroll_pig_heal#",
		ingds = {
			"papyrus", "honey", "nightmarefuel", "bandage",
		},
	},
	{
		prefab = "scroll_pig_health",
		img = "scroll_pig_health#",
		ingds = {
			"papyrus", "honey", "nightmarefuel", "dragonfruit",
		},
	},
	{
		prefab = "scroll_pig_teleport",
		img = "scroll_pig_teleport#",
		ingds = {
			"papyrus", "honey", "nightmarefuel", "butterflywings",
		},
	},
	{
		prefab = "tp_pack_beefalo",
		img = "backpack_beefalo#",
		ingds = {
			"papyrus", "papyrus", "rope", "beefalowool",
		},
	},
	{
		prefab = "tp_pack_catcoon",
		img = "backpack_catcoon#",
		ingds = {
			"papyrus", "papyrus", "rope", "coontail",
		},
	},
	{
		prefab = "tp_pack_crab",
		img = "backpack_crab#",
		ingds = {
			"papyrus", "papyrus", "rope", "crab",
		},
	},
	{
		prefab = "tp_pack_hound",
		img = "backpack_hound#",
		ingds = {
			"papyrus", "papyrus", "rope", "houndstooth",
		},
	},
	{
		prefab = "tp_pack_rabbit",
		img = "backpack_rabbit#",
		ingds = {
			"papyrus", "papyrus", "rope", "manrabbit_tail",
		},
	},
	{
		prefab = "tp_pack_deerclops",
		img = "backpack_deerclops#",
		ingds = {
			"papyrus", "papyrus", "rope", "deerclops_eyeball",
		},
	},
	{
		prefab = "tp_pack_dragonfly",
		img = "backpack_dragonfly#",
		ingds = {
			"papyrus", "papyrus", "rope", "dragon_scales",
		},
	},
	{
		prefab = "tp_pack_bearger",
		img = "backcub#",
		ingds = {
			"papyrus", "papyrus", "rope", "bearger_fur",
		},
	},
	{
		prefab = "tp_pack_giant",
		img = "giantsfoot#",
		ingds = {
			"papyrus", "papyrus", "rope", "bell",
		},
	},
	{
		prefab = "tp_pig_lamp",
		img = "pig_lamp#",
		ingds = {
			"nightmarefuel", "pigskin", "seashell", "tar",
		},
	},
	{
		prefab = "tp_magic_book",
		img = "waxwelljournal",
		ingds = {
			"papyrus", "papyrus", "nightmarefuel", "nightmarefuel",
		},
	},
},
-- Alchemy desk
{
	{
		prefab = "tp_potion_health_small",
		img = "tp_potion_health_small#",
		ingds = {
			"nightmarefuel", "messagebottleempty", "lightbulb", "blue_cap",
		},
	},
	{
		prefab = "tp_potion_sanity_small",
		img = "tp_potion_sanity_small#",
		ingds = {
			"nightmarefuel", "messagebottleempty", "lightbulb", "green_cap",
		},
	},
	{
		prefab = "tp_potion_brave_small",
		img = "tp_potion_brave_small#",
		ingds = {
			"nightmarefuel", "messagebottleempty", "lightbulb", "red_cap",
		},
	},
	{
		prefab = "tp_potion_crazy",
		img = "tp_potion_crazy#",
		ingds = {
			"nightmarefuel", "messagebottleempty", "lightbulb", "petals_evil",
		},
	},
	{
		prefab = "tp_potion_dry",
		img = "tp_potion_dry#",
		ingds = {
			"nightmarefuel", "messagebottleempty", "lightbulb", "flint",
		},
	},
	{
		prefab = "tp_potion_smell",
		img = "tp_potion_smell#",
		ingds = {
			"nightmarefuel", "messagebottleempty", "lightbulb", "petals",
		},
	},
	{
		prefab = "tp_potion_shine",
		img = "tp_potion_shine#",
		ingds = {
			"nightmarefuel", "messagebottleempty", "lightbulb", "algae",
		},
	},
	{
		prefab = "tp_potion_warth",
		img = "tp_potion_warth#",
		ingds = {
			"nightmarefuel", "messagebottleempty", "lightbulb", "redgem",
		},
	},
	{
		prefab = "tp_potion_iron",
		img = "tp_potion_iron#",
		ingds = {
			"nightmarefuel", "messagebottleempty", "lightbulb", "iron",
		},
	},
	{
		prefab = "tp_potion_metal",
		img = "tp_potion_metal#",
		ingds = {
			"nightmarefuel", "messagebottleempty", "lightbulb", "tentaclespots",
		},
	},
	{
		prefab = "tp_potion_shadow",
		img = "tp_potion_shadow#",
		ingds = {
			"nightmarefuel", "messagebottleempty", "lightbulb", "bluegem",
		},
	},
	{
		prefab = "tp_potion_killer",
		img = "tp_potion_killer#",
		ingds = {
			"nightmarefuel", "messagebottleempty", "lightbulb", "obsidian",
		},
	},
	{
		prefab = "tp_potion_detoxify",
		img = "tp_potion_detoxify#",
		ingds = {
			"nightmarefuel", "messagebottleempty", "lightbulb", "spidergland",
		},
	},
	{
		prefab = "tp_potion_warm",
		img = "tp_potion_warm#",
		ingds = {
			"nightmarefuel", "messagebottleempty", "lightbulb", "durian",
		},
	},
	{
		prefab = "tp_potion_cool",
		img = "tp_potion_cool#",
		ingds = {
			"nightmarefuel", "messagebottleempty", "lightbulb", "watermelon",
		},
	},
	{
		prefab = "tp_potion_horror",
		img = "tp_potion_horror#",
		ingds = {
			"nightmarefuel", "messagebottleempty", "lightbulb", "slurper_pelt",
		},
	},
	{
		prefab = "tp_plantable_reeds",
		img = "tp_plantable_reeds#",
		ingds = {
			"nightmarefuel", "messagebottleempty", "livinglog", "papyrus",
		},
	},
	{
		prefab = "tp_plantable_grass_water",
		img = "tp_plantable_grass_water#",
		ingds = {
			"nightmarefuel", "messagebottleempty", "livinglog", "dug_grass",
		},
	},
	{
		prefab = "tp_plantable_mangrove",
		img = "tp_plantable_mangrove#",
		ingds = {
			"nightmarefuel", "messagebottleempty", "livinglog", "jungletreeseed",
		},
	},
	{
		prefab = "tp_plantable_flower_cave",
		img = "tp_plantable_flower_cave#",
		ingds = {
			"nightmarefuel", "messagebottleempty", "livinglog", "fireflies",
		},
	},
},

}

local product_imgs = {
	ash = "ash",
	tp_pack_beefalo = "backpack_beefalo#",
	tp_pack_catcoon = "backpack_catcoon#",
	tp_pack_crab = "backpack_crab#",
	tp_pack_hound = "backpack_hound#",
	tp_pack_rabbit = "backpack_rabbit#",
	tp_pack_deerclops = "backpack_deerclops#",
	tp_pack_dragonfly = "backpack_dragonfly#",
	tp_pack_bearger = "backcub#",
	tp_pack_giant = "giantsfoot#",
	tp_pig_book = "pig_book#",
	tp_pig_lamp = "pig_lamp#",
	tp_hat_helm = "footballhat_combathelm2#",
	tp_spear_lance = "spear_forge_lance#",
	tp_spear_gungnir = "spear_forge_gungnir#",
	tp_ruinbat = "ruins_bat_heavy#",
	tp_cane = "cane_ancient#",
	tp_ballhat = "footballhat_combathelm#",
	tp_woodarmor = "armor_wood_fangedcollar#",
	tp_staff_trinity = "spear_bee#",
	tp_oak_armor = "armor_wood_haramaki#",
	tp_unreal_sword = "nightsword_sharp#",
	tp_brave_amulet = "amulet_red_occulteye#",
	tp_spear_wrestle = "spear_wathgrithr_wrestle#",
	tp_armor_lamellar = "armor_wood_lamellar#",
	tp_armor_ancient = "armor_ruins_tusk#",
	tp_armor_ancient2 = "armor_ruins_bulky#",
	tp_armor_ancient3 = "armor_ruins_leaf#",
	tp_hat_ancient = "ruinshat_arcane#",
	tp_spear_trap = "spear_rose#",
	tp_spear_mix = "spear_northern#",
	tp_bat_scythe = "batbat_scythe#",
	tp_magic_book = "waxwelljournal",
}

local function ProductImgClass()
	local product_img_class = {
		imgs = {},
		get_img = function(t, item)
			if t.imgs[item] then
				return t.imgs[item].atlas, t.imgs[item].img
			else
				local wgimg = WgImg(item.."#")
				return wgimg.atlas, wgimg.img
			end
		end,
	}
	for k, v in pairs(product_imgs) do
		product_img_class.imgs[k] = WgImg(v)
	end
	return product_img_class
end
local product_img_manager = ProductImgClass()

local desk_items = {
	scroll_tentacle = {tentaclespots=1, honey=1, papyrus=1, nightmarefuel=1},
	scroll_bird = {feather_robin=1, honey=1, papyrus=1, nightmarefuel=1},
	scroll_sleep = {nightmarefuel=2, honey=1, papyrus=1},
	scroll_lightning = {redgem=1, honey=1, papyrus=1, nightmarefuel=1},
	scroll_grow = {seeds=1, honey=1, papyrus=1, nightmarefuel=1},
	scroll_volcano = {obsidian=1, honey=1, papyrus=1, nightmarefuel=1},
	scroll_wind = {goose_feather=1, tp_gingko_leaf=2, papyrus=1},
	scroll_pigman = {pigskin=1, honey=1, papyrus=1, nightmarefuel=1},
	scroll_bunnyman = {manrabbit_tail=1, honey=1, papyrus=1, nightmarefuel=1},
	scroll_shadow = {purplegem=1, honey=1, papyrus=1, nightmarefuel=1},
	scroll_harvest = {berries=1, honey=1, papyrus=1, nightmarefuel=1},
	tp_pack_beefalo = {papyrus=2, rope=1, beefalowool=1},
	tp_pack_catcoon = {papyrus=2, rope=1, coontail=1},
	tp_pack_crab = {papyrus=2, rope=1, crab=1},
	tp_pack_hound = {papyrus=2, rope=1, houndstooth=1},
	tp_pack_rabbit = {papyrus=2, rope=1, manrabbit_tail=1},
	tp_pack_dragonfly = {papyrus=2, rope=1, dragon_scales=1},
	tp_pack_deerclops = {papyrus=2, rope=1, deerclops_eyeball=1},
	tp_pack_bearger = {papyrus=2, rope=1, bearger_fur=1},
	tp_pack_giant = {papyrus=2, rope=1, bell=1},
	scroll_pig_armor = {footballhat=1, papyrus=1, honey=1, nightmarefuel=1},
	scroll_pig_armorex = {armorwood=1, papyrus=1, honey=1, nightmarefuel=1},
	scroll_pig_damage = {hambat=1, papyrus=1, honey=1, nightmarefuel=1},
	scroll_pig_speed = {coffeebeans=1, papyrus=1, honey=1, nightmarefuel=1},
	scroll_pig_heal = {bandage=1, papyrus=1, honey=1, nightmarefuel=1},
	scroll_pig_teleport = {butterflywings=1, papyrus=1, honey=1, nightmarefuel=1},
	scroll_pig_health = {dragonfruit=1, papyrus=1, honey=1, nightmarefuel=1},
	-- tp_pig_book = {pigskin=2, papyrus=2},
	tp_pig_lamp = {pigskin=1, nightmarefuel=1, seashell=1, tar=1},
	tp_magic_book = {papyrus=2, nightmarefuel=2},
}

local lab_items = {
	tp_potion_brave_small = {nightmarefuel=1, messagebottleempty=1, lightbulb=1, red_cap=1},
	tp_potion_sanity_small = {nightmarefuel=1, messagebottleempty=1, lightbulb=1, green_cap=1},
	tp_potion_health_small = {nightmarefuel=1, messagebottleempty=1, lightbulb=1, blue_cap=1},
	tp_potion_dry = {flint=1, nightmarefuel=1, messagebottleempty=1, lightbulb=1},
	tp_potion_crazy = {petals_evil=1, nightmarefuel=1, messagebottleempty=1, lightbulb=1},
	tp_potion_smell = {petals=1, nightmarefuel=1, messagebottleempty=1, lightbulb=1},
	tp_potion_shine = {cutlichen=1, nightmarefuel=1, messagebottleempty=1, lightbulb=1},
	tp_potion_warth = {redgem=1, nightmarefuel=1, messagebottleempty=1, lightbulb=1},
	tp_potion_iron = {iron=1, nightmarefuel=1, messagebottleempty=1, lightbulb=1},
	tp_potion_metal = {tentaclespots=1, nightmarefuel=1, messagebottleempty=1, lightbulb=1},
	tp_potion_shadow = {bluegem=1, nightmarefuel=1, messagebottleempty=1, lightbulb=1},
	tp_potion_killer = {obsidian=1, nightmarefuel=1, messagebottleempty=1, lightbulb=1},
	tp_potion_warm = {durian=1, nightmarefuel=1, messagebottleempty=1, lightbulb=1},
	tp_potion_cool = {watermelon=1, nightmarefuel=1, messagebottleempty=1, lightbulb=1},
	tp_potion_detoxify = {spidergland=1, nightmarefuel=1, messagebottleempty=1, lightbulb=1},
	tp_potion_horror = {slurper_pelt=1, nightmarefuel=1, messagebottleempty=1, lightbulb=1},
	tp_plantable_flower_cave = {fireflies=1, nightmarefuel=1, messagebottleempty=1, livinglog=1},
	tp_plantable_grass_water = {dug_grass=1, nightmarefuel=1, messagebottleempty=1, livinglog=1},
	tp_plantable_mangrove = {jungletreeseed=1, nightmarefuel=1, messagebottleempty=1, livinglog=1},
	tp_plantable_reeds = {papyrus=1, nightmarefuel=1, messagebottleempty=1, livinglog=1},
}

local smelter_items = {
	tp_alloy = {bluegem=2, goldnugget=2},
	tp_spear_lance = {goldnugget=1, rope=1, twigs=2},
	tp_spear_ice = {tp_spear_lance=1, tp_alloy=1, bluegem=1, rope=1},
	tp_spear_fire = {tp_spear_lance=1, tp_alloy=1, redgem=1, rope=1},
	tp_spear_thunder = {tp_spear_lance=1, tp_alloy=1, purplegem=1, rope=1},
	tp_spear_gungnir = {goldnugget=1, rope=2, twigs=1},
	tp_spear_poison = {tp_spear_gungnir=1, tp_alloy=2, greengem=1},
	tp_spear_shadow = {tp_spear_gungnir=1, tp_alloy=2, yellowgem=1},
	tp_spear_blood = {tp_spear_gungnir=1, tp_alloy=2, orangegem=1},
	tp_ruinbat = {ruins_bat=1, tp_alloy=3},
	tp_cutlass = {dead_swordfish=1, tp_alloy=3},
	-- tp_cane = {cane=1, thulecite=3},
	tp_ballhat = {pigskin=1, rope=2, tp_alloy=1},
	tp_woodarmor = {boards=2, rope=1, houndstooth=1},
	tp_staff_trinity = {spear=1, redgem=1, bluegem=1, rope=1},
	tp_spear_wind = {tp_spear_lance=1, tp_gingko_leaf=1, tp_alloy=2},
	tp_oak_armor = {armorwood=1, tp_gingko_leaf=3},
	tp_forest_gun = {minotaurhorn=1, scroll_wind=3},
	tp_unreal_sword = {nightmarefuel=1, purplegem=1, tp_alloy=1, scroll_pig_health=1},
	tp_brave_amulet = {orangegem=1, greengem=1, yellowgem=1, nightmarefuel=1},
	tp_spear_wrestle = {goldnugget=2, rope=1, twigs=1},
	tp_spear_lightning = {tp_spear_wrestle=1, tp_alloy=1, purplegem=1, rope=1},
	tp_spear_earth = {tp_spear_wrestle=1, tp_alloy=1, redgem=1, rope=1},
	tp_spear_shine = {tp_spear_wrestle=1, tp_alloy=1, yellowgem=1, rope=1},
	tp_armor_lamellar = {boards=2, rope=1, goldnugget=1},
	tp_armor_health = {tp_armor_lamellar=1, tp_alloy=1, boards=1, redgem=1},
	tp_armor_firm = {tp_armor_lamellar=1, tp_alloy=1, boards=1, alloy=1},
	tp_armor_warm = {tp_armor_lamellar=1, tp_alloy=1, boards=1, heatrock=1},
	tp_armor_cool = {tp_armor_lamellar=1, tp_alloy=1, boards=1, transistor=1},
	tp_armor_thunder = {tp_armor_lamellar=1, tp_alloy=1, boards=1, purplegem=1},
	tp_armor_ancient = {armorruins=1, tp_alloy=2, purplegem=1},
	tp_armor_ancient2 = {armorruins=1, tp_alloy=2, redgem=1},
	tp_armor_ancient3 = {armorruins=1, tp_alloy=2, bluegem=1},
	tp_hat_helm = {pigskin=1, rope=1, goldnugget=2},
	tp_hat_health = {tp_hat_helm=1, tp_alloy=1, rope=1, goldnugget=1},
	tp_hat_warm = {tp_hat_helm=1, tp_alloy=1, rope=1, redgem=1},
	tp_hat_cool = {tp_hat_helm=1, tp_alloy=1, rope=1, bluegem=1},
	tp_hat_antitoxin = {tp_hat_helm=1, tp_alloy=1, rope=1, cactus_flower=1},
	tp_hat_ancient = {ruinshat=1, tp_alloy=3},
	tp_fix_powder = {goldnugget=2, flint=2},
	tp_ruinbat_deerclops = {deerclops_eyeball=1, tp_ruinbat=1, tp_alloy=1, tp_epic=1},
	tp_ruinbat_dragonfly = {dragon_scales=1, tp_ruinbat=1, tp_alloy=1, tp_epic=1},
	tp_ruinbat_bearger = {bearger_fur=1, tp_ruinbat=1, tp_alloy=1, tp_epic=1},
	tp_ruinbat_moose = {goose_feather=1, tp_ruinbat=1, tp_alloy=1, tp_epic=1},
	tp_spear_trap = {tp_spear_lance=1, tp_alloy=1, rope=1, petals=1},
	tp_spear_bag = {spear=1, tp_alloy=1, rope=1, pigskin=1},
	tp_spear_diamond = {tp_spear_diamond=1, tp_alloy=1, flint=2},
	tp_spear_combat = {tp_spear_lance=1, tp_alloy=1, rope=1, spear=1},
	tp_spear_beefalo = {spear=1, twigs=1, rope=1, beefalowool=1},
	tp_spear_gold = {tp_spear_gungnir=1, tp_alloy=1, rope=1, goldnugget=1},
	tp_spear_tornado = {tp_spear_wrestle=1, tp_alloy=1, rope=1, gears=1},
	tp_spear_conqueror = {spear=1, twigs=1, rope=1, redgem=1},
	tp_spear_speed = {spear=1, twigs=1, rope=1, cactus_meat=1},
	tp_bat_scythe = {twigs=1, rope=1, flint=1, batwing=1},
}

GLOBAL.WARGON.DATA.tp_data_composed = {
	desk_items = desk_items,
	lab_items = lab_items,
	smelter_items = smelter_items,
	product_img_manager = product_img_manager;
}

local function debug_composed(item)
	local ingds = desk_items[item] or lab_items[item] or smelter_items[item] or {}
	for k, v in pairs(ingds) do
		c_give(k, v)
	end
end

GLOBAL.WARGON.debug_composed = debug_composed

local function TitleClass()
	local title_class = {
		titles = {},
		add_title = function(t, title, n)
			n = n or 1
			for i = 1, n do
				table.insert(t.titles, title)
			end
		end,
		get_title = function(t, page)
			return t.titles[page]
		end,
		get_max_pages = function(t)
			return #t.titles
		end,
	}
	return title_class
end

local title_manager = TitleClass()
title_manager:add_title("战争熔炉合成表", 2)
title_manager:add_title("绘图台合成表")
title_manager:add_title("制药台合成表")

local function ItemClass(name, img, ingds)
	local item_class = {
		name = name,
		img = WgImg(img),
		ingds = {},
		get_prefab_name = function(t)
			return STRINGS.NAMES[string.upper(t.name)]
		end,
		get_desc_string = function(t)
			return STRINGS.CHARACTERS.GENERIC.DESCRIBE[string.upper(t.name)]
		end,
		get_img = function(t)
			return t.img.atlas, t.img.img
		end,
		get_ingds = function(t)
			return t.ingds
		end,
	}
	for i = 1, 4 do
		table.insert(item_class.ingds, WgImg(ingds[i]))
	end
	return item_class
end

local function ItemManagerClass()
	local item_manager_class = {
		items = {},
		add_bar = function(t)
			table.insert(t.items, {})
		end,
		add_item = function(t, n, item)
			table.insert(t.items[n], item)
		end,
		get_bar = function(t, n)
			return t.items[n]
		end,
	}
	return item_manager_class
end

local item_manager = ItemManagerClass()
for k, v in pairs(panel_data) do
	item_manager:add_bar()
	for k2, v2 in pairs(v) do
		item_manager:add_item(k, ItemClass(v2.prefab, v2.img, v2.ingds))
	end
end

local function ComposedPanelDataClass()
	local a_class = {
		cur_page = 1,
		max_page = 1,
		title_manager = TitleClass(),
		item_manager = ItemManagerClass(),
		get_title = function(t)
			return t.title_manager:get_title(t.cur_page)
		end,
		get_items = function(t)
			return item_manager:get_bar(t.cur_page)
		end,
		page_turn = function(t, dt)
			t.cur_page = math.min(t.max_page, math.max(1, t.cur_page+dt))
		end,
		get_ingds = function(t, item)
			for k, v in pairs(items) do
				if v.name == item then
					return v.ingds
				end
			end
		end,
	}
	return a_class
end

local composed_panel_data = ComposedPanelDataClass()
composed_panel_data.title_manager = title_manager
composed_panel_data.item_manager = item_manager
composed_panel_data.max_page = title_manager:get_max_pages()
GLOBAL.WARGON.DATA.composed_panel_data = composed_panel_data
